---
title: "【LPIC】シェル変数と環境変数の違い【setコマンドとenvコマンド】"
date: 2023-03-07T11:28:39+09:00
lastmod: 2023-03-07T11:28:39+09:00
draft: false
thumbnail: "images/lpic.jpg"
categories: [ "インフラ" ]
tags: [ "LPIC試験対策","Linux" ]
---

## シェル変数と環境変数の違い

シェル変数は設定されたシェルだけが使用する変数。

一方で環境変数は設定されたシェルとシェルで起動したプログラム(プロセス)が使用する変数。

### 環境変数とシェル変数の違いの事例

例えば、シェルからlsコマンドを実行して、lsのプロセスを起動する。

この時、lsのプロセスには環境変数は引き継がれるが、シェル変数は引き継がれない。


## 実際にシェル変数と環境変数を作ってみる

### まずはシェル変数を作ってみる

まずはシェル変数を作ってみる。

```
MESSAGE=test
```

これで、シェルの中にMESSAGEというシェル変数が作られた。値は`test`になる。

続けて、下記コマンドを打つ。

```
echo $MESSAGE
```

すると、ターミナル(シェル)にtestと表示された。

<div class="img-center"><img src="/images/Screenshot from 2023-03-07 11-41-50.png" alt=""></div>


<!--
この状態で、別のターミナル(シェル)を開いて、同様に

```
echo $MESSAGE
```

を実行した場合、`test`は表示されない。

<div class="img-center"><img src="/images/Screenshot from 2023-03-07 11-44-39.png" alt=""></div>

先程作ったシェル変数は存在しないからだ。
-->


以下のシェルスクリプトを作成してみる。ファイル名は任意で良い。実行権限を付与して実行する。

```
#! /bin/bash

echo ${MESSAGE}
```

シェルから起動された子プロセスは、シェル変数を読み取ることはできない。

<div class="img-center"><img src="/images/Screenshot from 2023-03-07 11-49-34.png" alt=""></div>

#### 【補足1】変数の波括弧がある場合と波括弧がない場合はどう違うのか？

波括弧の有無はどこまでが変数名であるかを明確にしている。つまり、以下は等価である

```
echo $MESSAGE

echo ${MESSAGE}
```
こちらも、等価である。
```
echo $MESSAGE test

echo ${MESSAGE} test
```

いずれも`${MESSAGE}`との間にスペースができる。スペースを作らないようにするには、こうする。

```
echo ${MESSAGE}test
```

波括弧が無いと、このようにスペース無しで文字列を連結させることができない。

```
# これだと別の変数扱いになってしまう。
echo $MESSAGEtest
```

### 続いて、環境変数を作ってみる

`export`コマンドを使用することで、環境変数を作ることができる。

```
MESSAGE=test
export MESSAGE
```
ちなみに、こちらでもよい。
```
export MESSAGE=test
```

これで環境変数のMESSAGEが作られた。

この状態で、先程のシェルスクリプトを動かしてみる。このように子プロセスは環境変数を読み取ることができた。

<div class="img-center"><img src="/images/Screenshot from 2023-03-07 12-02-04.png" alt=""></div>

このように環境変数は子プロセスから読み取りできるが、シェル変数は読み取りできない。

## シェル変数と環境変数の一覧を表示するコマンドは？

### シェル変数

```
set 
```
でシェル変数一覧が表示される。

主なシェル変数として、以下のようなものが有る。

|変数名|表示される値|
|:--:|:--:|
|PWD|カレントディレクトリの絶対パス|
|PATH|コマンド検索パス|
|HOME|ユーザーのホームディレクトリ|
|HOSTNAME|ホスト名|
|USER|ユーザー名|
|HISTSIZE|コマンド履歴の最大値|
|HISTFILE|コマンド履歴を格納するファイル|
|LANG|ロケール(言語と文字コード)|
|TERM|端末の種類|

ただ、一部は環境変数としても扱うことができるようになっている。例えば、PWDは環境変数でもある。

先程のシェルスクリプトに、`${PWD}`を追加してみよう。

```
#! /bin/bash

echo ${MESSAGE}
echo ${PWD}
```

正常に表示されている。ということは、PWDは環境変数でもあるということがわかる。

ちなみに、シェル変数の中から、検索をするには、以下のコマンドを実行する。例えば、PWDコマンドの検索であれば

```
set | grep "PWD"
```

こうする。これでシェル変数の中にPWDがあることがわかる。

### 環境変数

環境変数の一覧を表示するには、

```
env
```
と打てばよい。

こちらも、検索時にはgrepコマンドを使用する。

```
env | grep "PWD"
```


## 参照元

- https://qiita.com/kure/items/f76d8242b97280a247a1
- https://codezine.jp/unixdic/w/%E3%82%B7%E3%82%A7%E3%83%AB%E5%A4%89%E6%95%B0%E3%81%A8%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0
- https://qiita.com/yohm/items/3527d517768402efbcb6
